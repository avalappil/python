import serial
import time

servoSerial = serial.Serial('/dev/ttyACM3', 9600)
bluetoothSerial = serial.Serial('/dev/ttyAMA0', 9600)

def moveleft():
	try:	
		if (servoSerial.isOpen()):
			servoSerial.write("#1P1457#2P1130#3P1500#4P2217#5P1565#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1533#29P826#30P1500#31P1870#32P1457T1000\r\n")
			time.sleep(1.1)
			servoSerial.write("#1P1457#2P1130#3P1500#4P2217#5P1674#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1609#29P826#30P1500#31P1870#32P1565T1000\r\n")
			time.sleep(1.1)
			servoSerial.write("#1P1609#2P1130#3P1500#4P2217#5P1674#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1609#29P826#30P1500#31P1870#32P1565T1000\r\n")
			time.sleep(1.1)		
		else:
			servoSerial.close()
			servoSerial.open()
			servoSerial.write("#1P1457#2P1130#3P1500#4P2217#5P1565#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1533#29P826#30P1500#31P1870#32P1457T1000\r\n")
			time.sleep(1.1)
			servoSerial.write("#1P1457#2P1130#3P1500#4P2217#5P1674#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1609#29P826#30P1500#31P1870#32P1565T1000\r\n")
			time.sleep(1.1)
			servoSerial.write("#1P1609#2P1130#3P1500#4P2217#5P1674#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1609#29P826#30P1500#31P1870#32P1565T1000\r\n")
			time.sleep(1.1)			
	except:
		servoSerial.close()
		pass

def moveright():
	try:	
		if (servoSerial.isOpen()):
			servoSerial.write("#1P1457#2P1130#3P1500#4P2217#5P1565#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1533#29P826#30P1500#31P1870#32P1457T1000\r\n")
			time.sleep(1.1)
			servoSerial.write("#1P1340#2P1130#3P1500#4P2217#5P1570#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1500#29P826#30P1500#31P1870#32P1348T1000\r\n")
			time.sleep(1.1)
			servoSerial.write("#1P1435#2P1130#3P1500#4P2217#5P1565#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1457#29P826#30P1500#31P1870#32P1348T1000\r\n")
			time.sleep(1.1)
			servoSerial.write("#1P1543#2P1130#3P1500#4P2217#5P1565#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1500#29P826#30P1500#31P1870#32P1478T1000\r\n")
			time.sleep(1.1)
			servoSerial.write("#1P1543#2P1130#3P1500#4P2217#5P1565#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1543#29P826#30P1500#31P1870#32P1565T1000\r\n")
			time.sleep(1.1)
			servoSerial.write("#1P1457#2P1130#3P1500#4P2217#5P1565#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1533#29P826#30P1500#31P1870#32P1457T1000\r\n")
			time.sleep(1.1)
		else:
			servoSerial.close()
			servoSerial.open()
			servoSerial.write("#1P1457#2P1130#3P1500#4P2217#5P1565#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1533#29P826#30P1500#31P1870#32P1457T1000\r\n")
			time.sleep(1.1)
			servoSerial.write("#1P1340#2P1130#3P1500#4P2217#5P1570#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1500#29P826#30P1500#31P1870#32P1348T1000\r\n")
			time.sleep(1.1)
			servoSerial.write("#1P1435#2P1130#3P1500#4P2217#5P1565#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1457#29P826#30P1500#31P1870#32P1348T1000\r\n")
			time.sleep(1.1)
			servoSerial.write("#1P1543#2P1130#3P1500#4P2217#5P1565#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1500#29P826#30P1500#31P1870#32P1478T1000\r\n")
			time.sleep(1.1)
			servoSerial.write("#1P1543#2P1130#3P1500#4P2217#5P1565#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1543#29P826#30P1500#31P1870#32P1565T1000\r\n")
			time.sleep(1.1)
			servoSerial.write("#1P1457#2P1130#3P1500#4P2217#5P1565#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1533#29P826#30P1500#31P1870#32P1457T1000\r\n")
			time.sleep(1.1)			
	except:
		pass

def stand():
	try:	
		if (servoSerial.isOpen()):
			servoSerial.write("#1P1457#2P1130#3P1500#4P2217#5P1565#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1533#29P826#30P1500#31P1870#32P1457T3000\r\n")
			time.sleep(3.3)
		else:
			servoSerial.close()
			servoSerial.open()
			servoSerial.write("#1P1457#2P1130#3P1500#4P2217#5P1565#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1533#29P826#30P1500#31P1870#32P1457T3000\r\n")
			time.sleep(3.3)			
	except:
		pass

def turnleft():
	try:	
		if (servoSerial.isOpen()):
			servoSerial.write("#1P1457#2P1130#3P1500#4P2217#5P1565#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1533#29P826#30P1500#31P1870#32P1457T1000\r\n")
			time.sleep(1.3)
			servoSerial.write("#1P1587#2P1152#3P1652#4P2348#5P1652#8P2413#9P587#10P1565#14P1500#23P1478#24P2500#25P565#28P1565#29P826#30P1500#31P1870#32P1565T500\r\n")
			time.sleep(1.3)
			servoSerial.write("#1P1587#2P1348#3P1435#4P2326#5P1652#8P2413#9P587#10P1565#14P1500#23P1478#24P2500#25P565#28P1587#29P826#30P1500#31P1870#32P1565T500\r\n")
			time.sleep(1.3)
			servoSerial.write("#1P1457#2P1130#3P1500#4P2217#5P1565#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1533#29P826#30P1500#31P1870#32P1457T1000\r\n")
			time.sleep(1.3)
		else:
			servoSerial.close()
			servoSerial.open()
			servoSerial.write("#1P1457#2P1130#3P1500#4P2217#5P1565#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1533#29P826#30P1500#31P1870#32P1457T1000\r\n")
			time.sleep(1.3)
			servoSerial.write("#1P1587#2P1152#3P1652#4P2348#5P1652#8P2413#9P587#10P1565#14P1500#23P1478#24P2500#25P565#28P1565#29P826#30P1500#31P1870#32P1565T500\r\n")
			time.sleep(1.3)
			servoSerial.write("#1P1587#2P1348#3P1435#4P2326#5P1652#8P2413#9P587#10P1565#14P1500#23P1478#24P2500#25P565#28P1587#29P826#30P1500#31P1870#32P1565T500\r\n")
			time.sleep(1.3)
			servoSerial.write("#1P1457#2P1130#3P1500#4P2217#5P1565#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1533#29P826#30P1500#31P1870#32P1457T1000\r\n")
			time.sleep(1.3)			
	except:
		pass

def turnright():
	try:	
		if (servoSerial.isOpen()):
			servoSerial.write("#1P1457#2P1130#3P1500#4P2217#5P1565#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1533#29P826#30P1500#31P1870#32P1457T1000\r\n")
			time.sleep(1.3)
			servoSerial.write("#1P1348#2P1130#3P1500#4P2217#5P1543#8P2413#9P587#10P1565#14P1500#23P1478#24P2500#25P565#28P1457#29P826#30P1500#31P1870#32P1348T500\r\n")
			time.sleep(1.3)
			servoSerial.write("#1P1348#2P1196#3P1261#4P2022#5P1543#8P2413#9P587#10P1565#14P1500#23P1478#24P2500#25P565#28P1457#29P791#30P1804#31P1500#32P1348T500\r\n")
			time.sleep(1.3)
			servoSerial.write("#1P1391#2P1196#3P1261#4P2022#5P1543#8P2413#9P587#10P1565#14P1500#23P1478#24P2500#25P565#28P1500#29P1022#30P2065#31P1543#32P1326T500\r\n")
			time.sleep(1.3)
			servoSerial.write("#1P1457#2P1130#3P1500#4P2217#5P1565#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1533#29P826#30P1500#31P1870#32P1457T1000\r\n")
			time.sleep(1.3)
		else:
			servoSerial.close()
			servoSerial.open()			
			servoSerial.write("#1P1457#2P1130#3P1500#4P2217#5P1565#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1533#29P826#30P1500#31P1870#32P1457T1000\r\n")
			time.sleep(1.3)
			servoSerial.write("#1P1348#2P1130#3P1500#4P2217#5P1543#8P2413#9P587#10P1565#14P1500#23P1478#24P2500#25P565#28P1457#29P826#30P1500#31P1870#32P1348T500\r\n")
			time.sleep(1.3)
			servoSerial.write("#1P1348#2P1196#3P1261#4P2022#5P1543#8P2413#9P587#10P1565#14P1500#23P1478#24P2500#25P565#28P1457#29P791#30P1804#31P1500#32P1348T500\r\n")
			time.sleep(1.3)
			servoSerial.write("#1P1391#2P1196#3P1261#4P2022#5P1543#8P2413#9P587#10P1565#14P1500#23P1478#24P2500#25P565#28P1500#29P1022#30P2065#31P1543#32P1326T500\r\n")
			time.sleep(1.3)
			servoSerial.write("#1P1457#2P1130#3P1500#4P2217#5P1565#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1533#29P826#30P1500#31P1870#32P1457T1000\r\n")
			time.sleep(1.3)			
	except:
		pass

def walk():
	try:	
		if (servoSerial.isOpen()):
			servoSerial.write("#1P1565#2P1022#3P1500#4P2077#5P1674#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1630#29P826#30P1500#31P1870#32P1609T500\r\n")
			time.sleep(0.6)
			servoSerial.write("#1P1565#2P1087#3P1630#4P2304#5P1674#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1630#29P826#30P1500#31P1870#32P1609T500\r\n")
			time.sleep(0.6)
			servoSerial.write("#1P1565#2P1261#3P1435#4P2283#5P1674#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1630#29P826#30P1500#31P1870#32P1609T500\r\n")
			time.sleep(0.6)
			servoSerial.write("#1P1326#2P1130#3P1500#4P2217#5P1587#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1522#29P1000#30P1717#31P1804#32P1348T500\r\n")
			time.sleep(0.6)
			servoSerial.write("#1P1326#2P1130#3P1500#4P2217#5P1587#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1522#29P826#30P1500#31P1826#32P1370T500\r\n")
			time.sleep(0.6)
			servoSerial.write("#1P1326#2P1130#3P1500#4P2217#5P1543#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1522#29P848#30P1674#31P1696#32P1348T500\r\n")
			time.sleep(0.6)
		else:
			servoSerial.close()
			servoSerial.open()
			servoSerial.write("#1P1457#2P1130#3P1500#4P2217#5P1565#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1533#29P826#30P1500#31P1870#32P1457T1000\r\n")
			time.sleep(1.3)
			servoSerial.write("#1P1348#2P1130#3P1500#4P2217#5P1543#8P2413#9P587#10P1565#14P1500#23P1478#24P2500#25P565#28P1457#29P826#30P1500#31P1870#32P1348T500\r\n")
			time.sleep(1.3)
			servoSerial.write("#1P1348#2P1196#3P1261#4P2022#5P1543#8P2413#9P587#10P1565#14P1500#23P1478#24P2500#25P565#28P1457#29P791#30P1804#31P1500#32P1348T500\r\n")
			time.sleep(1.3)
			servoSerial.write("#1P1391#2P1196#3P1261#4P2022#5P1543#8P2413#9P587#10P1565#14P1500#23P1478#24P2500#25P565#28P1500#29P1022#30P2065#31P1543#32P1326T500\r\n")
			time.sleep(1.3)
			servoSerial.write("#1P1457#2P1130#3P1500#4P2217#5P1565#8P2413#9P587#10P1587#14P1500#23P1500#24P2500#25P587#28P1533#29P826#30P1500#31P1870#32P1457T1000\r\n")
			time.sleep(1.3)			
	except:
		pass

stand()
moveleft()
turnright()
servoSerial.open()
bluetoothSerial.open()
while True :
	time.sleep(1)
	try:
		if (bluetoothSerial.isOpen()):
			state=bluetoothSerial.read()
			print(state)

			if (state == "a"): #move left
				moveleft()
			if (state == "b"): #go straight
				walk()
			if (state == "c"): #move right
				moveright()

			if (state == "d"): #turn left
				turnleft()
			if (state == "e"): #stand still
				stand()
			if (state == "f"): #turn right
				turnright()

			print(filename)
			if (filename != ""):
				readData(filename)
		else:
			bluetoothSerial.close()
			bluetoothSerial.open()
	except:
		if (bluetoothSerial.isOpen()):
			pass
		else:
			bluetoothSerial.open()
		pass

bluetoothSerial.close()
servoSerial.close()